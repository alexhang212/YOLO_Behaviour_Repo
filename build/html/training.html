<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Model training &mdash; YOLO-Behaviour 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=e031e9a9"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Visualization and inference" href="inference.html" />
    <link rel="prev" title="Image annotation" href="annotation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            YOLO-Behaviour
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction and installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="annotation.html">Image annotation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Model training</a></li>
<li class="toctree-l1"><a class="reference internal" href="inference.html">Visualization and inference</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="validation.html">Validation and grid search</a></li>
<li class="toctree-l1"><a class="reference internal" href="human.html">Human in the loop methods</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">YOLO-Behaviour</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Model training</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/training.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="model-training">
<span id="training"></span><h1>Model training<a class="headerlink" href="#model-training" title="Permalink to this heading"></a></h1>
<p>After you have done some annotations and converted it into the YOLO format, you are now ready to train a YOLO model!</p>
<p>The training process is super simple, literally 4 lines of code, and I also prepared a quick script to do it.</p>
<p><h1> GPU access </h1></p>
<p>One thing to note before starting training is that ideally you should have a good GPU on your computer to train these models. GPU stands for “Graphical processing units”, originally mostly optimized to run computer games, but turned out to be super useful for deep learning models. Basically you really want a good GPU to be able to train + process the YOLO model, because it will be multiple magnitudes faster.</p>
<p>If you plan to start using computer vision/ deep learning in your research/ in the lab, I would recommend getting a gaming laptop/ gaming PC, with a good GPU for training and inference. Another option is to check with your institute/ university on whether they have a GPU cluster/ computing facility for you to train and deploy models. A lot of universities nowadays should have these facilities!</p>
<p>Finally, if all else fails, you can also consider cloud GPU. A lot of companies now provide GPU resource for model training for a given price. You can consider services like <a class="reference external" href="&quot;https://colab.research.google.com/signup&quot;">google collab</a>, which should be easy to setup.</p>
<p><h1> Model Training </h1>
Next is model training, you will need to setup a config file for YOLO, where you specify the path to your YOLO dataset. Our sample dataset provided all the datasets used in the original manuscript + their respective config files, under <code class="docutils literal notranslate"><span class="pre">./Data/YOLO_Datasets/</span></code>. You can copy and paste any of them to modify it accordingly for your dataset!</p>
<p>Here is what a config file looks like:</p>
<img alt="_images/YOLOConfig.png" src="_images/YOLOConfig.png" />
<p>All you have to do is to change the absolute path to where your YOLO folder is, and change the class and index for each trained class. If you used the label studio converter, the class order is determined automatically, and should have printed in the terminal when you ran the script.</p>
<p>Next, you can train the model using the <code class="docutils literal notranslate"><span class="pre">Code/2_TrainYOLO.py</span></code> script. Here are the arguments required:</p>
<ul class="simple">
<li><p>--Model: Type of YOLO model, which corresponds to different sizes. Bigger models are generally more accurate, but would occupy more of your GPU and run slower. So you can decide which one to use, the one used in the original manuscript is the YOLOv8-large models. Options include: n (nano), s (small), m (medium), l (large) or x (extra large)</p></li>
<li><p>--Config: Path to the YOLO config file</p></li>
<li><p>--Epochs: Total number of epochs to train</p></li>
</ul>
<p>To train a YOLOv8-l model on the Jay dataset, you can run this in the terminal:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="n">Code</span><span class="o">/</span><span class="mi">2</span><span class="n">_TrainYOLO</span><span class="o">.</span><span class="n">py</span> <span class="o">--</span><span class="n">Model</span> <span class="n">l</span> <span class="o">--</span><span class="n">Config</span>  <span class="s2">&quot;./Data/YOLO_Datasets/Jays_YOLO.yaml&quot;</span> <span class="o">--</span><span class="n">Epochs</span> <span class="mi">200</span>
</pre></div>
</div>
<p>Running this will then start the training process. Ultralytics will then automatically create a folder in the current directory called <code class="docutils literal notranslate"><span class="pre">runs/</span></code>, which is where they save all the training and validation statistics. Right when the training starts, you can check some of the visualizations of the training data to make sure everything is correct.</p>
<img alt="_images/YOLODuringTraining.png" src="_images/YOLODuringTraining.png" />
<p>The terminal should also print the current progress of the training, so you can keep track of how the model training is proceeding and how long it might take.</p>
<p>After training is finished, the folder above will be updated, with more statistics on the accuracy of the model. You can explore these images to determine how well the model performed to predict bounding boxes, but keep in mind for the actual application you will ideally have an annotated dataset to compare to, so these evaluation statistics are less important.</p>
<img alt="_images/YOLOAfterTraining.png" src="_images/YOLOAfterTraining.png" />
<p>Then finally, the most important is the final model weights, which is stored inside the <code class="docutils literal notranslate"><span class="pre">weights</span></code> folder. The weight you would want to save will be <code class="docutils literal notranslate"><span class="pre">best.pt</span></code>, which is the epoch with the lowest validation loss. I recommend copying the weight to another folder to be saved.</p>
<p>Congrats, you now have a trained model, you can then move on to visualize results and inference</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="annotation.html" class="btn btn-neutral float-left" title="Image annotation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="inference.html" class="btn btn-neutral float-right" title="Visualization and inference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Alex Chan Hoi Hang.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>